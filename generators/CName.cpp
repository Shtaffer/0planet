#include "CName.h"

int minLength = 4;
int maxLength = 7;
const double first[] = {0.12152506233, 0.021609951406, 0.0298782810965, 0.0270241365711, 0.0924823036355, 0.00965863896743, 0.0234748374073, 0.0400114967883, 0.0811392515056, 0.00913058880935, 0.0319303241159, 0.0530723829767, 0.0337617892211, 0.0746154925906, 0.0688804668231, 0.016075451015, 0.00107615285381, 0.0702908286377, 0.0581122541058, 0.0448107374655, 0.0360009892585, 0.0161289244487, 0.00983911180627, 0.00183814928446, 0.0186555441925, 0.00897685268737, };
const double next[][26] =
{
    {0.00613088098094, 0.0210582433693, 0.0335199253632, 0.0294548847128, 0.0143276022924, 0.00733040117286, 0.026456084233, 0.0157270425163, 0.0337198453952, 0.00859656137545, 0.047181127549, 0.0837664934026, 0.0622417699587, 0.208116753299, 0.0136612021858, 0.0154604824737, 0.000999600159936, 0.137744902039, 0.0659069705451, 0.0588431294149, 0.0328535252566, 0.0255897640944, 0.0147274423564, 0.00339864054378, 0.0225909636146, 0.0105957616953, },
    {0.189163795803, 0.0194174757282, 0.00219229564673, 0.00219229564673, 0.269339179455, 0.000626370184779, 0.000939555277169, 0.00814281240213, 0.0970873786408, 0.00156592546195, 0.00219229564673, 0.0350767303476, 0.00219229564673, 0.00250548073912, 0.132164108988, 0.000939555277169, 0.0, 0.122142186032, 0.0137801440651, 0.00187911055434, 0.0776699029126, 0.0, 0.00219229564673, 0.0, 0.0156592546195, 0.000939555277169, },
    {0.136873426413, 0.00114442664225, 0.0295262073701, 0.00389105058366, 0.0656900892653, 0.00160219729915, 0.00343327992676, 0.382467383841, 0.0574502174411, 0.000915541313802, 0.0810254062715, 0.03250171664, 0.00205996795605, 0.00205996795605, 0.114900434882, 0.0013733119707, 0.00434882124056, 0.0233463035019, 0.00549324788281, 0.00961318379492, 0.0203707942321, 0.000457770656901, 0.00022888532845, 0.0, 0.0112153810941, 0.00801098649577, },
    {0.2247036118, 0.0126826578439, 0.00330851943755, 0.0126826578439, 0.21146953405, 0.0046870692032, 0.0110283981252, 0.0129583677971, 0.116349600221, 0.00496277915633, 0.00578990901572, 0.0168183071409, 0.0143369175627, 0.00882271850014, 0.137303556658, 0.00275709953129, 0.000551419906259, 0.0601047697822, 0.0242624758754, 0.0190239867659, 0.0460435621726, 0.0046870692032, 0.0132340777502, 0.0, 0.0223325062035, 0.00909842845327, },
    {0.026305106763, 0.0162377202241, 0.0215149792969, 0.0293090850045, 0.0223268653081, 0.0101485751401, 0.0190793212633, 0.0112852155557, 0.0403507347568, 0.00543963627507, 0.0208654704879, 0.113501664366, 0.0322318746448, 0.148250385646, 0.0122594787692, 0.0143703823983, 0.000649508808963, 0.225217179508, 0.0754242104409, 0.0529349679305, 0.016156531623, 0.0326378176504, 0.0138832507916, 0.00487131606722, 0.0246001461395, 0.0101485751401, },
    {0.11671686747, 0.00527108433735, 0.00225903614458, 0.000753012048193, 0.183734939759, 0.125, 0.00451807228916, 0.00451807228916, 0.0963855421687, 0.00451807228916, 0.00150602409639, 0.0481927710843, 0.0120481927711, 0.00301204819277, 0.085843373494, 0.00225903614458, 0.0, 0.185993975904, 0.0120481927711, 0.0210843373494, 0.0775602409639, 0.00225903614458, 0.00225903614458, 0.0, 0.00225903614458, 0.0, },
    {0.192447830407, 0.00596223915204, 0.00794965220272, 0.0092745942365, 0.191122888374, 0.00264988406757, 0.0208678370321, 0.0486916197416, 0.0821464060947, 0.00463729711825, 0.00529976813514, 0.0433918516065, 0.0102683007618, 0.0327923153362, 0.104339185161, 0.00364359059291, 0.00231864855913, 0.089764822789, 0.0188804239815, 0.00960582974495, 0.0831401126201, 0.00099370652534, 0.00596223915204, 0.00331235508447, 0.0142431268632, 0.00629347466048, },
    {0.233705437523, 0.00414115952467, 0.00630176449406, 0.00306085703997, 0.17410875045, 0.000180050414116, 0.00162045372704, 0.00234065538351, 0.215160244869, 0.00126035289881, 0.00972272236226, 0.0219661505221, 0.015484335614, 0.0347497299244, 0.122614332013, 0.0010803024847, 0.0, 0.0304285199856, 0.00990277277638, 0.0151242347857, 0.0678790061217, 0.00378105869644, 0.00882247029168, 0.0, 0.0165646380987, 0.0, },
    {0.102370384361, 0.0135990178487, 0.0733780338087, 0.0328642931344, 0.0585513268486, 0.00812163565965, 0.0309755406554, 0.00868826140334, 0.00424969307772, 0.0155822079516, 0.0440079327604, 0.0723392199452, 0.0446689961281, 0.188497497403, 0.0288979129285, 0.0132212673529, 0.00151100198319, 0.0460855604873, 0.0931154972141, 0.0566625743696, 0.0120880158655, 0.013126829729, 0.00604400793276, 0.00424969307772, 0.013032392105, 0.0140712059685, },
    {0.232484076433, 0.00398089171975, 0.00557324840764, 0.0103503184713, 0.147292993631, 0.000796178343949, 0.0015923566879, 0.0015923566879, 0.171178343949, 0.000796178343949, 0.0111464968153, 0.0015923566879, 0.0031847133758, 0.0111464968153, 0.267515923567, 0.000796178343949, 0.0, 0.00238853503185, 0.0111464968153, 0.00398089171975, 0.101910828025, 0.00238853503185, 0.0, 0.0, 0.00636942675159, 0.000796178343949, },
    {0.24860724234, 0.00324976787372, 0.00232126276695, 0.00162488393686, 0.135329619313, 0.000928505106778, 0.00162488393686, 0.0380687093779, 0.163881151346, 0.00208913649025, 0.00882079851439, 0.0315691736305, 0.00719591457753, 0.00742804085422, 0.168291550604, 0.00208913649025, 0.0, 0.0306406685237, 0.0201949860724, 0.00487465181058, 0.0772980501393, 0.00371402042711, 0.00580315691736, 0.000232126276695, 0.0338904363974, 0.000232126276695, },
    {0.164823159907, 0.0143383859074, 0.00887614365697, 0.0376894715281, 0.179161545815, 0.0116072647822, 0.0101051481633, 0.00723747098184, 0.165642496245, 0.00204834084392, 0.0102417042196, 0.135736719924, 0.018844735764, 0.00450634985662, 0.0846647548819, 0.00996859210706, 0.000546224225044, 0.00450634985662, 0.0273112112522, 0.0199371842141, 0.0364604670217, 0.00887614365697, 0.00273112112522, 0.0, 0.0296326642087, 0.00450634985662, },
    {0.361348034117, 0.0289161639276, 0.0270438943208, 0.00228832951945, 0.120449344706, 0.00124817973788, 0.00104014978157, 0.00436862908259, 0.172456833784, 0.00187226960682, 0.00332847930102, 0.00353650925733, 0.0232993551071, 0.00499271895153, 0.1219055544, 0.025171624714, 0.00104014978157, 0.00540877886416, 0.0174745163304, 0.00249635947576, 0.0515914291658, 0.000624089868941, 0.00228832951945, 0.0, 0.0143540669856, 0.0014562096942, },
    {0.125841184388, 0.0171601615074, 0.0315163750561, 0.0818752803948, 0.121467025572, 0.0057200538358, 0.0964558097802, 0.0136832660386, 0.111148497084, 0.00785105428443, 0.0324136384029, 0.00930910722297, 0.0125616868551, 0.0555181695828, 0.0817631224764, 0.00583221175415, 0.00112157918349, 0.0117765814266, 0.059443696725, 0.0573126962764, 0.0154777927322, 0.00325257963212, 0.0059443696725, 0.00112157918349, 0.0216464782414, 0.0127860026918, },
    {0.00733603416183, 0.0316434906383, 0.0239789773349, 0.0281397131282, 0.018285338881, 0.0145625752765, 0.0162049709843, 0.0307675462608, 0.0133581517574, 0.00689806197306, 0.0304390671192, 0.0894558195555, 0.048614912953, 0.175736340742, 0.0218986094383, 0.0210226650608, 0.000547465235958, 0.115515164787, 0.0870469725172, 0.048614912953, 0.0447826563013, 0.0759881747509, 0.020037227636, 0.0025183400854, 0.0158764918428, 0.0107303186248, },
    {0.210413999146, 0.00426803243705, 0.00213401621852, 0.000853606487409, 0.198036705079, 0.00640204865557, 0.00128040973111, 0.0832266325224, 0.111395646607, 0.0, 0.00682885189927, 0.0413999146394, 0.00384122919334, 0.00256081946223, 0.129748186086, 0.0529236022194, 0.0, 0.063593683312, 0.0179257362356, 0.0136577037985, 0.0367050789586, 0.0, 0.000426803243705, 0.0, 0.0110968843363, 0.00128040973111, },
    {0.00641025641026, 0.0, 0.0, 0.0, 0.00641025641026, 0.0, 0.0, 0.0, 0.185897435897, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00641025641026, 0.0, 0.0, 0.0, 0.0, 0.0, 0.775641025641, 0.0128205128205, 0.00641025641026, 0.0, 0.0, 0.0, },
    {0.160693015701, 0.0162425554954, 0.0180833784515, 0.0387655657823, 0.116946399567, 0.00454791553871, 0.0341093665403, 0.00898754737412, 0.155928532756, 0.00184082295615, 0.0214401732539, 0.0188413643747, 0.022198159177, 0.0316188413644, 0.127774769897, 0.00649702219816, 0.000974553329724, 0.030752571738, 0.0353004872767, 0.0534921494315, 0.04721169464, 0.00617217108825, 0.0040064970222, 0.000541418516513, 0.0322685435842, 0.00476448294532, },
    {0.128064243449, 0.00929839391378, 0.0610030994646, 0.00352211890673, 0.105945336715, 0.00309946463793, 0.00267681036912, 0.127500704424, 0.0732600732601, 0.00169061707523, 0.0612848689772, 0.0177514792899, 0.0152155536771, 0.00817131586362, 0.0786136939983, 0.0185967878276, 0.0018315018315, 0.0032403493942, 0.0608622147084, 0.129050436743, 0.0605804451958, 0.00662158354466, 0.00605804451958, 0.000140884756269, 0.00972104818259, 0.00619892927585, },
    {0.164248021108, 0.00395778364116, 0.00939973614776, 0.00230870712401, 0.166062005277, 0.00296833773087, 0.0032981530343, 0.0961411609499, 0.0992744063325, 0.00494722955145, 0.00775065963061, 0.0117084432718, 0.00890501319261, 0.00461741424802, 0.138522427441, 0.00197889182058, 0.0, 0.0651385224274, 0.0595316622691, 0.0770118733509, 0.029518469657, 0.00296833773087, 0.00494722955145, 0.000164907651715, 0.0146767810026, 0.0199538258575, },
    {0.0315008025682, 0.0371187800963, 0.0541733547352, 0.0405296950241, 0.0463483146067, 0.0100321027287, 0.0367174959872, 0.0138443017657, 0.033507223114, 0.0112359550562, 0.0459470304976, 0.0666131621188, 0.0583868378812, 0.111155698234, 0.0116372391653, 0.0146468699839, 0.00100321027287, 0.136035313002, 0.134430176565, 0.0533707865169, 0.00280898876404, 0.00662118780096, 0.00441412520064, 0.00561797752809, 0.0158507223114, 0.0164526484751, },
    {0.275594622544, 0.00103412616339, 0.00258531540848, 0.00206825232678, 0.223888314374, 0.0, 0.00517063081696, 0.00155118924509, 0.288521199586, 0.00103412616339, 0.00879007238883, 0.0155118924509, 0.000517063081696, 0.00620475698035, 0.0801447776629, 0.00155118924509, 0.0, 0.011892450879, 0.0465356773526, 0.00258531540848, 0.00620475698035, 0.0, 0.0, 0.0, 0.0180972078594, 0.000517063081696, },
    {0.352033660589, 0.00350631136045, 0.00140252454418, 0.00280504908836, 0.195652173913, 0.00280504908836, 0.00070126227209, 0.0294530154278, 0.195652173913, 0.0, 0.0112201963534, 0.0203366058906, 0.0070126227209, 0.0161290322581, 0.0743338008415, 0.00140252454418, 0.0, 0.0161290322581, 0.0357643758766, 0.00140252454418, 0.0217391304348, 0.0, 0.00070126227209, 0.0, 0.00981767180926, 0.0, },
    {0.176767676768, 0.010101010101, 0.0353535353535, 0.010101010101, 0.126262626263, 0.010101010101, 0.00505050505051, 0.0151515151515, 0.308080808081, 0.00505050505051, 0.0151515151515, 0.020202020202, 0.0, 0.0, 0.0555555555556, 0.00505050505051, 0.0, 0.020202020202, 0.010101010101, 0.020202020202, 0.131313131313, 0.00505050505051, 0.0151515151515, 0.0, 0.0, 0.0, },
    {0.259101654846, 0.0156028368794, 0.0264775413712, 0.0222222222222, 0.0633569739953, 0.010401891253, 0.012293144208, 0.0141843971631, 0.0316784869976, 0.00756501182033, 0.0189125295508, 0.0567375886525, 0.0326241134752, 0.0671394799054, 0.11158392435, 0.0146572104019, 0.000472813238771, 0.0359338061466, 0.0496453900709, 0.0255319148936, 0.0992907801418, 0.00378250591017, 0.0113475177305, 0.00378250591017, 0.00236406619385, 0.00330969267139, },
    {0.207317073171, 0.0104529616725, 0.00522648083624, 0.0191637630662, 0.163763066202, 0.000871080139373, 0.00609756097561, 0.127177700348, 0.116724738676, 0.0, 0.0121951219512, 0.0104529616725, 0.01393728223, 0.0121951219512, 0.0714285714286, 0.00174216027875, 0.000871080139373, 0.00871080139373, 0.0209059233449, 0.0104529616725, 0.104529616725, 0.00871080139373, 0.0113240418118, 0.0, 0.0148083623693, 0.0409407665505, },
};

CName::CName(double seed)
{
    gen.setSeed(seed);
}

int CName::getFirstSymbol()
{
    double p = gen.Next();
    double s = 0.0;
    double eps = 1e-12;
    int i;
    for (i = 0; i < 26; i++)
    {
        s += first[i];
        if (p <= s+eps)
            break;
    }
    return i;
}

int CName::getNextSymbol(int prev)
{
    double p = gen.Next();
    double s = 0.0;
    double eps = 1e-12;
    int i;
    for (i = 0; i < 26; i++)
    {
        s += next[prev][i];
        if (p <= s+eps)
            break;
    }
    return i;
}

STRING_TYPE CName::NextName()
{
    STRING_TYPE res = "";
    int length = minLength + gen.NextInt(maxLength-minLength);
    int prev = getFirstSymbol();
    res += (CHAR_TYPE)('A' + prev);
    for (int i = 1; i < length; i++)
    {
        prev = getNextSymbol(prev);
        res += (CHAR_TYPE)('a' + prev);
    }
    return res;
}
